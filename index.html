
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>李略帅</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="leaker">
    

    
    <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="李略帅">
<meta property="og:url" content="http://www.leelib.com/index.html">
<meta property="og:site_name" content="李略帅">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="李略帅">
<meta name="twitter:description">

    
    <link rel="alternative" href="/atom.xml" title="李略帅" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/apple.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/apple.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="李略帅" title="李略帅"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="李略帅">李略帅</a></h1>
				<h2 class="blog-motto">少壮不努力，一生在内地</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/disappear">消失</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.leelib.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/09/16/vs2013-command-prompt-here.html" title="Win10里添加目录右键菜单 VS2013 Command Prompt Here" itemprop="url">Win10里添加目录右键菜单 VS2013 Command Prompt Here</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2015-09-15T20:08:21.000Z" itemprop="datePublished"> 发表于 2015-09-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="需求">需求</h1><p>我有时需要在命令行里对某个VS项目目录进行编译或部署等操作，总是需要以下步骤：</p>
<ol>
<li>打开VS的Command Prompt</li>
<li>进入该项目目录</li>
<li>进行编译操作</li>
</ol>
<p>个人觉得这样太浪费时间，于是萌生了添加类似 <strong>Command Here</strong> 右键菜单的想法。<br>办法很简单，在注册表添加相关项就可以了</p>
<h1 id="解决方案">解决方案</h1><h2 id="Windows7_添加方法">Windows7 添加方法</h2><p>将以下内容修改到自己对应VS目录后以文本形式保存到 VS2013-Command-Prompt-Here-win7.reg 文件，然后双击导入即可<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00&#10;&#10;[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Folder\shell\VS2013 Command Prompt Here]&#10;&#10;[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Folder\shell\VS2013 Command Prompt Here\command]&#10;@=&#34;cmd.exe /s /k pushd \&#34;%1\&#34; &#38; \&#34;C:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\VC\\vcvarsall.bat\&#34; x86&#34;</span><br></pre></td></tr></table></figure></p>
<h2 id="Windows10_添加方法">Windows10 添加方法</h2><p>将以下内容修改到自己对应VS目录后以文本形式保存到 VS2013-Command-Prompt-Here-win10.reg 文件，然后双击导入即可<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00&#10;&#10;[HKEY_CLASSES_ROOT\Directory\Background\shell\VS2013 Command Prompt Here]&#10;&#10;[HKEY_CLASSES_ROOT\Directory\Background\shell\VS2013 Command Prompt Here\command]&#10;@=&#34;cmd.exe /s /k pushd \&#34;%V\&#34; &#38; \&#34;C:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\VC\\vcvarsall.bat\&#34; x86&#34;</span><br></pre></td></tr></table></figure></p>
<h1 id="为什么区分Windows版本">为什么区分Windows版本</h1><p>因为对于Windows来说传参的方式有所改变<br><strong>pushd %1</strong> 是用于Windows7的<br><strong>pushd %V</strong> 是用于Windows10的</p>
<h1 id="下载">下载</h1><p>for Windows7: <a href="/files/regfiles/VS2013-Command-Prompt-Here-win7.reg">VS2013-Command-Prompt-Here-win7.reg</a><br>for Windows10: <a href="/files/regfiles/VS2013-Command-Prompt-Here-win10.reg">VS2013-Command-Prompt-Here-win10.reg</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/经验总结/">经验总结</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/VS2013/">VS2013</a><a href="/tags/Windows10/">Windows10</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/09/14/vs2013-build-openssl-static.html" title="VS2013静态编译openssl批处理" itemprop="url">VS2013静态编译openssl批处理</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2015-09-14T04:26:46.000Z" itemprop="datePublished"> 发表于 2015-09-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="打开_Visual_Studio_2013_Command_Prompt">打开 Visual Studio 2013 Command Prompt</h1><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.nasm.us/pub/nasm/releasebuilds/<span class="number">2</span>.<span class="number">11</span>.<span class="number">08</span>/win32/nasm-<span class="number">2</span>.<span class="number">11</span>.<span class="number">08</span>-win32.zip</span><br><span class="line">unzip nasm-<span class="number">2</span>.<span class="number">11</span>.<span class="number">08</span>-win32.zip -d C:/nasm</span><br><span class="line"><span class="keyword">set</span> <span class="built_in">PATH</span>=<span class="envvar">%PATH%</span>;C:/nasm/</span><br><span class="line">wget https://www.openssl.org/source/openssl-<span class="number">1</span>.<span class="number">0</span>.<span class="number">2</span>d.tar.gz</span><br><span class="line">tar xzf openssl-<span class="number">1</span>.<span class="number">0</span>.<span class="number">2</span>d.tar.gz</span><br><span class="line"><span class="built_in">cd</span> openssl-<span class="number">1</span>.<span class="number">0</span>.<span class="number">2</span>d</span><br><span class="line">perl configure VC-WIN32 --prefix=C:/openssl</span><br><span class="line">ms\do_nasm</span><br><span class="line">nmake -f ms\nt.mak</span><br><span class="line">nmake -f ms\nt.mak install</span><br><span class="line"><span class="keyword">echo</span> "build successed."</span><br></pre></td></tr></table></figure>
<p>这样编译不会产生 <strong>error A2070:invalid instruction operands</strong> 这个错误</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/A2070/">A2070</a><a href="/tags/nasm/">nasm</a><a href="/tags/nmake/">nmake</a><a href="/tags/openssl/">openssl</a><a href="/tags/perl/">perl</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/08/05/fun-battle-net-client-error.html" title="好玩的暴雪战网错误提示" itemprop="url">好玩的暴雪战网错误提示</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2015-08-05T14:08:24.000Z" itemprop="datePublished"> 发表于 2015-08-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><img src="/images/20150805/battle-net-error.jpg" alt=""></p>
<p>可能是网络或者其他原因引起的。但没想到暴雪竟然会萌萌的掀桌子 0.0///</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/闲言碎语/">闲言碎语</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/02/09/fix-std-max-error.html" title="VS里std::max和max宏混淆问题的解决方案" itemprop="url">VS里std::max和max宏混淆问题的解决方案</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2015-02-09T03:27:16.000Z" itemprop="datePublished"> 发表于 2015-02-09</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>有时,把旧项目转换成新版本项目时,旧版本项目里使用的 max 和 min 宏无法在新版本中正常编译.</p>
<p>原因是: 新版本内有了新的函数 std::max 和 std::min 函数来实现这一功能</p>
<h4 id="这时可以尝试使用如下方案解决:">这时可以尝试使用如下方案解决:</h4><ol>
<li>包含algorithm文件（#include <algorithm>）</algorithm></li>
<li>明确使用 std::max(a,b) 而非 max(a,b)</li>
<li>定义宏 NOMINMAX</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>►<a class="article-category-link" href="/categories/C-C/经验总结/">经验总结</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/algorithm/">algorithm</a><a href="/tags/max/">max</a><a href="/tags/min/">min</a><a href="/tags/std/">std</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/01/16/windows-dll-freelibrary-self.html" title="Windows下的DLL卸载本身模块的方法" itemprop="url">Windows下的DLL卸载本身模块的方法</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2015-01-15T17:35:37.000Z" itemprop="datePublished"> 发表于 2015-01-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在 Windows 里 DLL 卸载自身模块是无法通过字节调用 FreeLibrary 自己来实现的。</p>
<h2 id="原因分析">原因分析</h2><blockquote>
<p>在当前线程中调用 FreeLibrary 后，当前模块就会立即被释放掉，而当前线程还没有运行结束。所以程序就运行到了一块不可访问的内存里，产生异常从而导致程序崩溃。</p>
</blockquote>
<h2 id="解决方案">解决方案</h2><blockquote>
<p>Windows 里面 提供了一条可以用来释放自身模块的函数 <strong>FreeLibraryAndExitThread</strong> 可以释放自身。</p>
</blockquote>
<p>函数</p>
<pre><code>VOID WINAPI <span class="function"><span class="title">FreeLibraryAndExitThread</span><span class="params">(_In_ HMODULE hLibModule, _In_ DWORD dwExitCode)</span></span>
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/FreeLibrary/">FreeLibrary</a><a href="/tags/FreeLibraryAndExitThread/">FreeLibraryAndExitThread</a><a href="/tags/dll/">dll</a><a href="/tags/windows/">windows</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/01/06/linux-auth-log.html" title="Linux里面查看登录日志，并统计次数和排序，查看尝试破解密码的IP" itemprop="url">Linux里面查看登录日志，并统计次数和排序，查看尝试破解密码的IP</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2015-01-06T05:42:53.000Z" itemprop="datePublished"> 发表于 2015-01-06</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>仅需一条命令</p>
<pre><code><span class="title">grep</span> <span class="string">"Failed password for root"</span> /var/log/secure | awk <span class="string">'{print <span class="variable">$11</span>}'</span> | sort | uniq -c | sort -nr | more


结果类似下面这样：

   <span class="number">4377</span> <span class="number">103.41.124.18</span>
   <span class="number">4368</span> <span class="number">103.41.124.65</span>
   <span class="number">3900</span> <span class="number">62.210.178.226</span>
   <span class="number">2214</span> <span class="number">103.41.124.33</span>
    <span class="number">409</span> <span class="number">62.210.142.105</span>
    <span class="number">404</span> <span class="number">115.231.222.45</span>
    <span class="number">152</span> <span class="number">122.225.97.91</span>
     <span class="number">95</span> <span class="number">122.225.109.205</span>
     <span class="number">81</span> <span class="number">109.195.69.233</span>
     <span class="number">42</span> <span class="number">74.52.105.154</span>
     <span class="number">21</span> <span class="number">87.106.184.62</span>
     <span class="number">21</span> <span class="number">87.106.1.211</span>
     <span class="number">21</span> <span class="number">82.165.154.23</span>
     <span class="number">21</span> <span class="number">69.64.64.62</span>
     <span class="number">21</span> <span class="number">67.226.156.239</span>
     <span class="number">21</span> <span class="number">61.40.192.52</span>
     <span class="number">21</span> <span class="number">60.213.190.98</span>
     <span class="number">21</span> <span class="number">27.251.179.130</span>
     <span class="number">21</span> <span class="number">222.77.190.33</span>
     <span class="number">21</span> <span class="number">211.172.219.251</span>
     <span class="number">21</span> <span class="number">210.249.105.10</span>
     <span class="number">15</span> <span class="number">220.194.46.36</span>
     <span class="number">12</span> <span class="number">203.184.128.106</span>
      <span class="number">1</span> <span class="number">60.190.71.52</span>
      <span class="number">1</span> <span class="number">193.104.41.58</span>
</code></pre><p>这样我们就可以很清楚的了解有谁在尝试破解我们的密码了，之后做个相关安全策略就可以简单防治了</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/CentOS/">CentOS</a>►<a class="article-category-link" href="/categories/CentOS/RedHat/">RedHat</a>►<a class="article-category-link" href="/categories/CentOS/RedHat/Ubuntu/">Ubuntu</a>►<a class="article-category-link" href="/categories/CentOS/RedHat/Ubuntu/经验总结/">经验总结</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/awk/">awk</a><a href="/tags/grep/">grep</a><a href="/tags/linux/">linux</a><a href="/tags/secure/">secure</a><a href="/tags/sort/">sort</a><a href="/tags/uniq/">uniq</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/12/30/linux-git-remote-helper-for-https.html" title="Linux里Git出现fatal: Unable to find remote helper for &#39;https&#39;的解决方案" itemprop="url">Linux里Git出现fatal: Unable to find remote helper for &#39;https&#39;的解决方案</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2014-12-30T15:42:43.000Z" itemprop="datePublished"> 发表于 2014-12-30</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在Linux内源码编译安装的Git如果出现了 “<strong>Unable to find remote helper for ‘https’</strong>” 错误，则说明<strong>编译没有完全</strong>。</p>
<p>解决办法就是在编译之前安装相关的开发包就可以了。<br>在CentOS系统中使用下面命令来安装：</p>
<pre><code>yum <span class="keyword">install</span> curl-devel expat-devel gettext-devel openssl-devel zlib-devel
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>►<a class="article-category-link" href="/categories/C-C/CentOS/">CentOS</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/fatal/">fatal</a><a href="/tags/git/">git</a><a href="/tags/https/">https</a><a href="/tags/linux/">linux</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/12/25/git-remote-helper-for-https.html" title="Windows里Git出现fatal: Unable to find remote helper for &#39;https&#39;的解决方案" itemprop="url">Windows里Git出现fatal: Unable to find remote helper for &#39;https&#39;的解决方案</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2014-12-25T08:10:02.000Z" itemprop="datePublished"> 发表于 2014-12-25</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在升级win8.1之后，重新安装的Git虽然可以正常使用<br>但遇到https时会报“<strong>Unable to find remote helper for ‘https’</strong>”的错误</p>
<p>网络搜索了许久未果，于是自己研究</p>
<blockquote>
<ol>
<li>检查安装的文件<br>结果：所有文件均完整<p></p></li>
<li><p>检查文件的访问权限<br>结果：所有文件当前用户均可访问</p>
</li>
<li><p>为调用的git等exe文件授予管理员运行权限<br>结果：问题依旧存在</p>
</li>
</ol>
</blockquote>
<p></p><p>按理说，只要当前用户拥有文件的所有访问权限，就可以正常使用了。<br>并且，按这个错误来分析。应该是remote-https模块没有权限访问</p>
<p>挣扎了半天，尝试重装解决。</p>
<p>在重装的时候选择了 <strong>管理员权限运行</strong><br>结果意外的发现重装后，https可以正常使用了。</p>
<p>至此问题解决。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/经验总结/">经验总结</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/git/">git</a><a href="/tags/https/">https</a><a href="/tags/remote/">remote</a><a href="/tags/windows/">windows</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/11/21/python-simple-crypt-code.html" title="python代码简单加密解密工具" itemprop="url">python代码简单加密解密工具</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2014-11-21T11:13:45.000Z" itemprop="datePublished"> 发表于 2014-11-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <pre><code><span class="built_in">#</span><span class="built_in">!</span>/usr/env python
<span class="string">""</span><span class="string">"
:license: MIT

Copyright (C) 2012 HustMoon

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "</span>Software<span class="string">"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "</span>AS IS<span class="string">", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
"</span><span class="string">""</span>
from __future__ <span class="built_in">import</span> with_statement

<span class="built_in">import</span> zlib, sys

def b128encode<span class="params">(buf, escape=False)</span>:
    <span class="keyword">if</span> not buf: return ''
    buf = bytearray<span class="params">(buf)</span>
    res = bytearray<span class="params">(<span class="params">(len<span class="params">(buf)</span> * <span class="number">8</span> + <span class="number">6</span>)</span> / <span class="number">7</span>)</span>
    p, s, i = <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>
    <span class="keyword">for</span> n in buf:
        res[i] = <span class="params">(<span class="params">(p &lt;&lt; <span class="params">(<span class="number">8</span> - s)</span> | <span class="params">(n &gt;&gt; s)</span>)</span> &amp;amp; <span class="number">0</span>x7F)</span> | <span class="number">0</span>x80; i += <span class="number">1</span>
        <span class="keyword">if</span> s == <span class="number">7</span>:
            res[i] = n | <span class="number">0</span>x80; i += <span class="number">1</span>
            p, s = <span class="number">0</span>, <span class="number">1</span>
        <span class="keyword">else</span>:
            p, s = n, <span class="params">(s + <span class="number">1</span>)</span> <span class="built_in">%</span> <span class="number">8</span>
    <span class="keyword">if</span> s <span class="built_in">!</span>= <span class="number">1</span>:
        <span class="keyword">if</span> s == <span class="number">2</span> and p &lt; <span class="number">0</span>x80:
            i -= <span class="number">1</span>
        <span class="keyword">else</span>:
            p = <span class="params">(p &lt;&lt; <span class="params">(<span class="number">8</span> - s)</span>)</span> &amp;amp; <span class="number">0</span>x7F
        p = <span class="built_in">chr</span><span class="params">(p)</span>
        <span class="keyword">if</span> escape:
            p = p.encode<span class="params">('string-escape')</span>
        res[i:] = p
    return <span class="built_in">str</span><span class="params">(res)</span>

def dcode<span class="params">()</span>:
    code = r'''def code<span class="params">(__=code)</span>:
 <span class="params">(_______)</span>=<span class="params">(globals)</span><span class="params">()</span>;del<span class="params">(<span class="params">(_______)</span>['code'])</span>
 <span class="keyword">if</span><span class="params">(<span class="params">(<span class="params">(_______)</span>.get<span class="params">('__doc__')</span>)</span>is<span class="params">(<span class="params">(None)</span>)</span>)</span>:
  <span class="params">(__)</span>=<span class="params">(map)</span><span class="params">(<span class="params">(ord)</span>,<span class="params">(__)</span>[<span class="params">(<span class="number">339</span>)</span>:])</span>;<span class="params">(______)</span>=[<span class="number">0</span>]<span class="built_in">*</span><span class="params">(<span class="params">(<span class="params">(<span class="params">(<span class="params">(len)</span><span class="params">(<span class="params">(__)</span>)</span>+<span class="params">(<span class="number">1</span>)</span>)</span>*<span class="params">(<span class="number">7</span>)</span>)</span>/<span class="params">(<span class="number">8</span>)</span>)</span>)</span>;<span class="params">(<span class="params">(___)</span>,<span class="params">(____)</span>,<span class="params">(_____)</span>)</span>=<span class="params">(<span class="params">(<span class="number">0</span>)</span>,<span class="params">(<span class="number">0</span>)</span>,<span class="params">(<span class="number">0</span>)</span>)</span>
  <span class="keyword">for</span><span class="params">(<span class="params">(__)</span>)</span>in<span class="params">(<span class="params">(__)</span>)</span>:
   <span class="keyword">if</span><span class="params">(<span class="params">(__)</span>&lt;<span class="params">(<span class="number">128</span>)</span>)</span>:break
   <span class="keyword">if</span><span class="params">(<span class="params">(____)</span>==<span class="params">(<span class="number">0</span>)</span>)</span>:<span class="params">(<span class="params">(___)</span>,<span class="params">(____)</span>)</span>=<span class="params">(<span class="params">(__)</span>,<span class="params">(<span class="number">1</span>)</span>)</span>
   <span class="keyword">else</span>:
    <span class="params">(______)</span>[<span class="params">(_____)</span>]=<span class="params">(<span class="params">(<span class="params">(<span class="params">(___)</span>&lt;&lt;<span class="params">(____)</span>)</span>|<span class="params">(<span class="params">(<span class="params">(__)</span>&amp;amp;<span class="params">(<span class="number">127</span>)</span>)</span>&gt;&gt;<span class="params">(<span class="params">(<span class="number">7</span>)</span>-<span class="params">(____)</span>)</span>)</span>)</span>&amp;amp;<span class="params">(<span class="number">255</span>)</span>)</span>;<span class="params">(_____)</span>+=<span class="params">(<span class="number">1</span>)</span>;<span class="params">(<span class="params">(___)</span>,<span class="params">(____)</span>)</span>=<span class="params">(<span class="params">(__)</span>,<span class="params">(<span class="params">(<span class="params">(____)</span>+<span class="params">(<span class="number">1</span>)</span>)</span>%<span class="params">(<span class="number">8</span>)</span>)</span>)</span>
  <span class="keyword">if</span><span class="params">(<span class="params">(__)</span>&lt;<span class="params">(<span class="number">128</span>)</span>)</span>:
   <span class="keyword">if</span><span class="params">(<span class="params">(____)</span>!=<span class="params">(<span class="number">0</span>)</span>)</span>:
    <span class="params">(__)</span>=<span class="params">(<span class="params">(<span class="params">(<span class="params">(___)</span>&lt;&lt;<span class="params">(____)</span>)</span>|<span class="params">(<span class="params">(__)</span>&gt;&gt;<span class="params">(<span class="params">(<span class="number">7</span>)</span>-<span class="params">(____)</span>)</span>)</span>)</span>&amp;amp;<span class="params">(<span class="number">255</span>)</span>)</span>
   <span class="params">(______)</span>[<span class="params">(_____)</span>:]=[<span class="params">(<span class="params">(__)</span>)</span>]
  elif<span class="params">(<span class="params">(____)</span>!=<span class="params">(<span class="number">0</span>)</span>)</span>:del<span class="params">(<span class="params">(______)</span>[<span class="params">(_____)</span>:])</span>
  exec<span class="params">(<span class="params">(''.join<span class="params">(<span class="params">(map)</span><span class="params">(<span class="params">(chr)</span>,<span class="params">(______)</span>)</span>)</span>.decode<span class="params">('zlib')</span>)</span>)</span>in<span class="params">(<span class="params">(_______)</span>)</span>
  <span class="keyword">if</span><span class="params">(<span class="params">(<span class="params">(_______)</span>.get<span class="params">('__doc__')</span>)</span>is<span class="params">(<span class="params">(None)</span>)</span>)</span>:<span class="params">(_______)</span>['__doc__']=''
code<span class="params">()</span>
'''
    return ''.join<span class="params">([c.encode<span class="params">('string-escape')</span> if ord<span class="params">(c)</span> &lt; <span class="number">128</span> else c
                    for c in zlib.compress<span class="params">(code, <span class="number">9</span>)</span>])</span>
dcode = dcode<span class="params">()</span>

def encode<span class="params">(infile, outfile)</span>:
    with open<span class="params">(infile, 'rU')</span> as fp:
        code = fp.read<span class="params">()</span>.rstrip<span class="params">('n')</span> + 'n'
    code = b128encode<span class="params">(zlib.compress<span class="params">(code, <span class="number">9</span>)</span>, True)</span>
    code = r'''<span class="built_in">#</span> -<span class="built_in">*</span>- coding: latin-<span class="number">1</span> -<span class="built_in">*</span>-
code = '<span class="built_in">%</span>s'
exec<span class="params">(code.decode<span class="params">('zlib')</span>)</span>
''' <span class="built_in">%</span> <span class="params">(dcode + code)</span>
    with open<span class="params">(outfile, 'wb')</span> as fp:
        fp.write<span class="params">(code)</span>

def decode<span class="params">(infile, outfile)</span>:
    with open<span class="params">(infile, 'rU')</span> as fp:
        code = fp.read<span class="params">()</span>.rstrip<span class="params">('n')</span> + 'n'
    code = code.replace<span class="params">(<span class="string">"exec(code.decode('zlib'))"</span>, <span class="string">"exec(code.decode('zlib')"</span>
        <span class="string">".replace('exec','fp.write').replace('in((_______))',''))"</span>)</span>
    with open<span class="params">(outfile, 'wb')</span> as fp:
        eval<span class="params">(compile<span class="params">(code, 's', 'exec')</span>, {'fp':fp})</span>

def main<span class="params">()</span>:
    try:
        <span class="keyword">if</span> sys.argv[<span class="number">1</span>] == '-d':
            func = decode
            infile, outfile = sys.argv[<span class="number">2</span>:<span class="number">4</span>]
        <span class="keyword">else</span>:
            func = encode
            infile, outfile = sys.argv[<span class="number">1</span>:<span class="number">3</span>]
    except ValueError:
        print &gt;&gt;sys.stderr, 'Usage: zipcode.py [-d] infile.py outfile.py'
        raise SystemExit<span class="params">(-<span class="number">1</span>)</span>
    func<span class="params">(infile, outfile)</span>

<span class="keyword">if</span> __name__ == '__main__':
    main<span class="params">()</span>
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Uncategorized/">Uncategorized</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/11/21/vs2013-use-atl.html" title="VS2013上直接使用ATL的注意事项" itemprop="url">VS2013上直接使用ATL的注意事项</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="leaker" target="_blank" itemprop="author">leaker</a>
		
  <p class="article-time">
    <time datetime="2014-11-21T04:15:21.000Z" itemprop="datePublished"> 发表于 2014-11-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>不再需要导入atl.lib库了，直接包含以下头文件就可以了</p>
</blockquote>
<pre><code><span class="preprocessor">#<span class="keyword">include</span> &lt;atlbase.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;atlcom.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;atlctl.h&gt;</span>


&gt; 要使用 AtlAxAttachControl 等函数的话，则必须初始化ATL模块

CComModule _Module;
_pAtlModule = &amp;amp;_Module;
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>►<a class="article-category-link" href="/categories/C-C/经验总结/">经验总结</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/atl/">atl</a><a href="/tags/com/">com</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
		
		  
			<li><a href="/categories/C-C/" title="C/C++">C/C++<sup>22</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/" title="CentOS">CentOS<sup>13</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/" title="CentOS">CentOS<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/Python/" title="Python">Python<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/Python/" title="Python">Python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/RedHat/" title="RedHat">RedHat<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/RedHat/" title="RedHat">RedHat<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/Python/RedHat/" title="RedHat">RedHat<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/RedHat/" title="RedHat">RedHat<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/RedHat/Ubuntu/" title="Ubuntu">Ubuntu<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/RedHat/Ubuntu/" title="Ubuntu">Ubuntu<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/Ubuntu/" title="Ubuntu">Ubuntu<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Ubuntu/" title="Ubuntu">Ubuntu<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/Ubuntu/" title="Ubuntu">Ubuntu<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/Python/RedHat/Ubuntu/" title="Ubuntu">Ubuntu<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Uncategorized/" title="Uncategorized">Uncategorized<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/好站收集/" title="好站收集">好站收集<sup>1</sup></a></li>
		  
		
		  
		
		  
			<li><a href="/categories/我的作品/" title="我的作品">我的作品<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/RedHat/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/Python/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Ubuntu/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/RedHat/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/经验总结/" title="经验总结">经验总结<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/Python/RedHat/Ubuntu/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/RedHat/Ubuntu/经验总结/" title="经验总结">经验总结<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/RedHat/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/经验总结/" title="经验总结">经验总结<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/RedHat/Ubuntu/经验总结/" title="经验总结">经验总结<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/Ubuntu/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/CentOS/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/C-C/CentOS/Ubuntu/经验总结/" title="经验总结">经验总结<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/闲言碎语/" title="闲言碎语">闲言碎语<sup>4</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/linux/" title="linux">linux<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/ubuntu/" title="ubuntu">ubuntu<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/centos/" title="centos">centos<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/zlib/" title="zlib">zlib<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/windows/" title="windows">windows<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/install/" title="install">install<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/python/" title="python">python<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/c/" title="c">c<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/yum/" title="yum">yum<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/libc/" title="libc">libc<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/git/" title="git">git<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/sudo/" title="sudo">sudo<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/make/" title="make">make<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/compress/" title="compress">compress<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/kernel-devel/" title="kernel-devel">kernel-devel<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/ln/" title="ln">ln<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/https/" title="https">https<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/gcc/" title="gcc">gcc<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/SAFESEH/" title="SAFESEH">SAFESEH<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/编译/" title="编译">编译<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m Leaker&#39;s Blog in github. <br/>
			Living without an aim is like sailing without a compass.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo" rel="external nofollow">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman" rel="external nofollow">Jacman</a> © 2015 
		
		<a href="/about" target="_blank" title="leaker">leaker</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
